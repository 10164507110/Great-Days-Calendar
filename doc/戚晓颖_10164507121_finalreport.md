# è¯´æ˜
> å…³äºæ–‡æ¡£çš„è¯´æ˜ï¼šå„ä½å¿…é¡»ä½¿ç”¨markdownæ¥è¿›è¡Œæ–‡æ¡£æè¿°ï¼Œæ–‡æ¡£è§„èŒƒæ€§ä¹Ÿæ˜¯è€ƒè™‘çš„è¦ç´ ä¹‹ä¸€ï¼Œè¿™ä¸ªæ–‡ä»¶æ”¾åˆ°ä»¬é¡¹ç›®çš„docæ–‡ä»¶å¤¹ä¸­ï¼Œæ¯ä¸ªäººçš„æŠ¥å‘Šå‘½åä¸º å§“å_å­¦å·_finalreport.mdã€‚
> ä½ å¯ä»¥æŒ‰ç…§å¦‚ä¸‹å›¾ç¤ºè·å–æ­¤æ–‡æ¡£çš„markdownæºæ–‡ä»¶ã€‚
> **è¯·åœ¨2018-1-15 17:00ä¹‹å‰äº¤çº¸è´¨ç­¾å­—ç‰ˆï¼ˆåŠå…¬å®¤æ–‡ç§‘å¤§æ¥¼729ï¼‰**ã€‚
  
![template source](https://cloud.githubusercontent.com/assets/1710178/21607358/8845c01c-d1f0-11e6-8374-86abc8605756.png)
  
>ä»¥ä¸‹å¼€å§‹æ­£æ–‡......
# äº§å“åˆ›æ„
>ä½ ä»¬éœ€è¦åœ¨è¿™é‡Œæè¿°ä½ ä»¬çš„äº§å“åˆ›æ„çš„è¿‡ç¨‹ï¼ŒåŒ…æ‹¬ä½ ä»¬çš„çµæ„Ÿæ¥æºï¼Œé’ˆå¯¹ä»€ä¹ˆäººç¾¤æ¥è®¾è®¡è¿™ä¸ªäº§å“ï¼Œä½ ä»¬è®¾è®¡äº†å“ªäº›åŠŸèƒ½ï¼Ÿä¸€å¼€å§‹åšçš„åŸå‹çš„æ ·å­ï¼ˆéœ€è¦é™„å›¾ï¼Œè¦ç”¨markdownæ’å…¥ä½ çš„å›¾ç‰‡ï¼Œå…³äºå›¾ç‰‡å¯ä»¥åœ¨githubä¸­ä½¿ç”¨ä¿®æ”¹æ­¤æ–‡æ¡£çš„æ–¹å¼ç›´æ¥ä¸Šä¼ ï¼‰  
>ä½ åœ¨åˆ›æ„é˜¶æ®µæ‰€åšçš„è´¡çŒ®æ˜¯ä»€ä¹ˆï¼Ÿ
>*æ­¤éƒ¨åˆ†æ¯ç»„åŒå­¦ä¹‹é—´å¯ä»¥æœ‰ç›¸åŒçš„å†…å®¹*ï¼Œæ€»å­—æ•°ä¸èƒ½å°‘äº1000å­—ã€‚  

## åˆ›æ„
> åœ¨è¿™é‡Œï¼Œä½ éœ€è¦å‘Šè¯‰è¯»è€…ä½ ä»¬çš„é¡¹ç›®çš„çµæ„Ÿæ¥æºï¼Œéœ€è¦å…·ä½“æè¿°æ€ä¹ˆå°±æƒ³åˆ°è¿™ä¸ªåˆ›æ„çš„ã€‚  

## éœ€æ±‚     

æˆ‘ä»¬çš„æ—¥å†ä¸»è¦é’ˆå¯¹å¤§å­¦ç”Ÿç¾¤ä½“é¢å¯¹ç¹æ‚ã€ä¸è§„å¾‹çš„æ—¥ç¨‹å®‰æ’çš„æƒ…å¢ƒï¼Œå› æ­¤åœ¨åŠŸèƒ½è®¾è®¡ä¸Šä¹ŸåŠ›æ±‚å°½å¯èƒ½çš„ç®€æ´æ˜äº†ï¼Œå¸®åŠ©ç”¨æˆ·é™ä½åœ¨æ—¥ç¨‹ç®¡ç†ä¸Šçš„æ—¶é—´æ¶ˆè€—ï¼Œå¤§å¤§å‡å°‘å…¶å¿˜è®°æˆªæ­¢æ—¥æœŸï¼Œå¿˜è®°æ—¥ç¨‹çš„æƒ…å†µã€‚

### 1.æ—¥å†ç•Œé¢
- æŸ¥çœ‹å½“æœˆæ—¥å†åŠå½“æ—¥æ—¥ç¨‹ï¼šé»˜è®¤ä¸»ç•Œé¢æ˜¾ç¤ºå½“æœˆæ—¥å†ï¼Œç”¨æˆ·å¯é€šè¿‡æŒ‰é”®è·³è½¬è‡³ä¸åŒæœˆä»½æŸ¥çœ‹ã€‚å³ä¾§è¯¦æƒ…ç•Œé¢é»˜è®¤æ˜¾ç¤ºæ—¥ç¨‹åˆ—è¡¨ã€‚
- åŒºåˆ†ä¸åŒäº‹ä»¶ï¼šä¸åŒçŠ¶æ€çš„æ—¥å†æ ¼å­ï¼ˆæœ‰æ—¥ç¨‹/æ— æ—¥ç¨‹/ç¾¤ç»„æ—¥ç¨‹/ä¸ªäººæ—¥ç¨‹ç­‰ï¼‰æ˜¾ç¤ºé¢œè‰²/æ ·å¼ä¸åŒã€‚

### 2.ä¸ªäººä¸ç¾¤ç»„
å¼•å…¥ç¾¤ç»„æ¦‚å¿µï¼Œç¾¤ç»„åˆ›å»ºè€…å¯åŒæ­¥æ·»åŠ æ—¥ç¨‹ç»™å…¨ä½“ç¾¤ç»„æˆå‘˜ã€‚

- æŸ¥çœ‹å½“å‰æ‰€åœ¨ç¾¤ç»„ï¼šç”¨æˆ·ç‚¹å‡»å›¾æ ‡å‡ºç°ç¾¤ç»„åˆ—è¡¨ã€‚
- åˆ›å»ºç¾¤ç»„ï¼šç‚¹å‡»åˆ›å»ºå›¾æ ‡ï¼Œä»»ä½•ç”¨æˆ·éƒ½å¯åˆ›å»ºç¾¤ç»„ã€‚éœ€å¡«å†™ç¾¤ç»„åç§°ã€‚åˆ›å»ºè€…ä¸ºç¾¤ç»„ç®¡ç†å‘˜ã€‚
- åŠ å…¥ç¾¤ç»„ï¼šé€šè¿‡è¾“å…¥ç¾¤ç»„åç§°ï¼Œå¯åŠ å…¥ç¾¤ç»„ã€‚
  
### 3.æ—¥ç¨‹ç®¡ç† 
- æ–°å»ºæ—¥ç¨‹ï¼šç‚¹å‡»æŒ‰é’®å¯æ–°å»ºæ—¥ç¨‹ã€‚æ–°å»ºæ—¥ç¨‹ä¸­åŒ…æ‹¬ï¼šæ—¥ç¨‹å†…å®¹ï¼Œæé†’æ—¶é—´ï¼Œæ—¥ç¨‹æè¿°ï¼Œå‚ä¸äººç­‰è¦ç´ ã€‚ç¾¤ç»„åˆ›å»ºè€…å¯ä»¥é€‰æ‹©å‚ä¸ç¾¤ç»„ã€‚éåˆ›å»ºè€…ä¹Ÿå¯åˆ›å»ºä¸ªäººæ—¥ç¨‹ã€‚
- æ·»åŠ ä¸ªäººå¤‡å¿˜å½•ï¼šåœ¨æ—¥ç¨‹è¯¦æƒ…ä¸­ï¼Œå¯æ·»åŠ ä¸ªäººå¤‡å¿˜å½•ã€‚

### 4.æ³¨å†Œç™»å½•
ç”¨æˆ·æ³¨å†Œè´¦å·ä»…éœ€å¡«å†™ç”¨æˆ·åï¼Œå¯†ç å¹¶ç»‘å®šå…¶å¸¸ç”¨çš„æ¥æ”¶é‚®ç®±ï¼Œä¸éœ€è¦å…¶ä»–ä¿¡æ¯ã€‚

### 5.å®šæœŸé‚®ä»¶æé†’
ç”¨æˆ·ç»‘å®šé‚®ç®±åï¼Œç³»ç»Ÿå®šæœŸä¼šæ£€æŸ¥ç”¨æˆ·å½“å‰æ—¥ç¨‹çŠ¶æ€ã€‚å½“äº‹ä»¶è¾¾åˆ°è®¾å®šæé†’æ—¶é—´æ—¶ï¼Œè‡ªåŠ¨å‘äº‹ä»¶å‚ä¸äººé‚®ç®±å‘é€æé†’é‚®ä»¶ã€‚

### 6.å…±æœ‰æ—¶é—´æŸ¥è¯¢
ç¾¤ç»„ç®¡ç†å‘˜åœ¨ä¸ºç¾¤ç»„æ·»åŠ æœªæ¥è®¡åˆ’æ—¶ï¼Œå¯å¯¹ç¾¤ç»„å†…æˆå‘˜çš„å…±åŒç©ºä½™æ—¶é—´è¿›è¡ŒæŸ¥è¯¢ï¼Œä»è€Œå®Œæˆç»Ÿç­¹å®‰æ’ã€‚

## è®¾è®¡çš„åŠŸèƒ½åˆ—è¡¨ä»¥åŠå…¶å®Œæˆæƒ…å†µ

è®¾è®¡çš„åŠŸèƒ½|æ‰¿æ‹…è¯¥åŠŸèƒ½çš„ç»„å‘˜|ä»»åŠ¡å®Œæˆåº¦
------|------|------
åŠŸèƒ½x|ç»„å‘˜x|å®Œæˆåº¦
åŠŸèƒ½x|ç»„å‘˜x|å®Œæˆåº¦

# äº§å“æŠ€æœ¯æ–¹æ¡ˆ

## æ•´ä½“æ¡†æ¶
å®Œæ•´Great Daysæ—¥å†åœ¨å®ç°ä¸Šä¸»è¦ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šå®¢æˆ·ç«¯ï¼ŒæœåŠ¡å™¨å’Œæ•°æ®åº“ã€‚å®¢æˆ·ç«¯ä¸»è¦ç”¨äºä¸ç”¨æˆ·ä¹‹é—´çš„ç›´æ¥äº¤äº’ã€‚å½“ç”¨æˆ·äº§ç”Ÿå¦‚ç™»å½•ã€æ³¨å†Œã€å¢åŠ ç¾¤ç»„ã€å¢åŠ äº‹ä»¶ç­‰æ“ä½œæ—¶ï¼Œä¼šå¯¹æœåŠ¡å™¨è¿›è¡Œå¯¹åº”è¯·æ±‚ã€‚æœåŠ¡å™¨æ ¹æ®è¯·æ±‚å†…å®¹è¿›è¡Œå¤„ç†ï¼Œåœ¨å¿…è¦æ—¶è¿æ¥æ•°æ®åº“è¿›è¡Œç›¸å…³å¢ã€åˆ ã€æŸ¥ã€æ”¹çš„æ“ä½œã€‚æœåŠ¡å™¨å¤„ç†å®Œæ¯•åä¼šè¿”å›ä¿¡æ¯ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ç›´æ¥åé¦ˆç»™ç”¨æˆ·ã€‚

## å…·ä½“æ–¹æ¡ˆæè¿°

ä¸‹å›¾ç²—ç•¥æç»˜äº†é’ˆå¯¹ç”¨æˆ·è¿›è¡Œæ³¨å†Œå’Œç™»å½•æ“ä½œçš„å…·ä½“æµç¨‹ï¼Œé€šè¿‡è¯¥æµç¨‹å¯¹å…·ä½“æ–¹æ¡ˆè¿›è¡Œè§£é‡Šï¼Œå…³äºæ—¥å†ç•Œé¢çš„å…¶ä»–æ“ä½œå…¶å®ä¸ä¹‹åŒç†ã€‚

![myPlan](https://raw.githubusercontent.com/ECNU-DEIT-2016/Great-Days-Calendar/master/pic/myidea.png)

### 1.å®¢æˆ·ç«¯
å®¢æˆ·ç«¯éœ€è¦å®Œæˆç•Œé¢å’Œä¸ç”¨æˆ·çš„äº¤äº’ååº”ã€‚åœ¨ç”¨æˆ·è¿›è¡Œæ“ä½œåï¼Œè¿›è¡Œååº”åˆ¤æ–­ï¼Œå¹¶ç»™äºˆç”¨æˆ·åé¦ˆã€‚å¦‚ï¼šç”¨æˆ·ç‚¹å‡»"å»æ³¨å†Œ"æŒ‰é’®ï¼Œè·³è½¬è‡³æ³¨å†Œé¡µé¢ï¼›å½“ç”¨æˆ·åœ¨æœªè¾“å…¥å®Œæ•´ç”¨æˆ·åã€å¯†ç çš„æƒ…å†µä¸‹ç‚¹å‡»"ç™»å½•"æŒ‰é’®ï¼Œé¡µé¢è·³å‡ºé”™è¯¯æé†’ã€‚

ä¸Šé¢æåˆ°çš„å‡ ç§ååº”æƒ…å†µéƒ½æ˜¯ä»…åœ¨å®¢æˆ·ç«¯ä¸Šè¿›è¡Œçš„æƒ…å†µã€‚è€Œå¦å¤–ä¸€äº›éœ€è¦è·å–ä¿¡æ¯ã€å‘é€ä¿¡æ¯ç­‰çš„æ“ä½œåˆ™éœ€è¦é€šè¿‡å‘æœåŠ¡å™¨å‘é€å„ç±»httpè¯·æ±‚ï¼Œå¦‚post,getç­‰ã€‚å‘é€æˆåŠŸåä¼šå—åˆ°æ¥è‡ªæœåŠ¡å™¨çš„åé¦ˆç»“æœï¼ˆå¯èƒ½æ˜¯æ•°æ®ï¼›ä¹Ÿå¯èƒ½æ˜¯æˆåŠŸ/å¤±è´¥ä¿¡æ¯ï¼‰ï¼Œå®¢æˆ·ç«¯éœ€è¦å¯¹å…¶è¿›è¡Œåˆ¤æ–­ï¼Œå¹¶ä»¥ä¸åŒæ–¹å¼å‘ˆç°ç»™ç”¨æˆ·ã€‚å¦‚ï¼šç”¨æˆ·ç‚¹å‡»"å‘é€éªŒè¯ç "æŒ‰é’®ï¼Œå®¢æˆ·ç«¯ä¼šé¦–å…ˆéªŒè¯é‚®ç®±åœ°å€æ˜¯å¦åˆæ³•ï¼Œå¦‚æœåˆæ³•ï¼Œå®¢æˆ·ç«¯å¯¹è¯·æ±‚è¿›è¡Œå°è£…åå‘æœåŠ¡å™¨å‘é€ï¼ŒæœåŠ¡å™¨å¤„ç†å®Œæ¯•åå°†responseä¼ é€’ç»™å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯æ ¹æ®è¿”å›çš„çŠ¶æ€ç è¿›è¡Œåé¦ˆï¼Œå¦‚æœçŠ¶æ€ç ä¸º200ï¼Œåˆ™æç¤ºç”¨æˆ·å·²å‘é€æˆåŠŸï¼Œå¦åˆ™æç¤ºå¤±è´¥ã€‚

### 2.æœåŠ¡å™¨
æœåŠ¡å™¨åªæœ‰åœ¨æ¥å—åˆ°å®¢æˆ·ç«¯å‘æ¥çš„åˆæ³•è¯·æ±‚æ—¶æ‰ä¼šå·¥ä½œã€‚æœåŠ¡å™¨ä¸Šçš„æ“ä½œåŒæ ·æœ‰ä¸¤ç§ç±»å‹ï¼Œä¸€ç§æ˜¯ä»…åœ¨æœåŠ¡å™¨ä¸Šå®Œæˆçš„è¯·æ±‚ï¼Œå¦ä¸€ç§åˆ™éœ€è¦è¿æ¥æ•°æ®åº“å®Œæˆã€‚å¦‚åœ¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘æ¥çš„sendemailè¯·æ±‚åï¼ŒæœåŠ¡å™¨ä¼šå¯¹è¯·æ±‚è¿›è¡Œè§£æï¼Œä¸»è¦æ˜¯è·å–è¯·æ±‚ä¸­çš„ä¿¡æ¯ï¼ˆæœ¬ä¾‹ä¸­ä¸»è¦æŒ‡é‚®ç®±å’ŒéªŒè¯ç ï¼‰ï¼Œè§£æå®Œæˆåå‘æŒ‡å®šé‚®ç®±å‘é€é‚®ä»¶ï¼Œå‘é€æˆåŠŸåè¿”å›æˆåŠŸä¿¡æ¯ç»™å®¢æˆ·ç«¯ï¼Œå¤±è´¥åˆ™å‘é€å¤±è´¥ä¿¡æ¯ã€‚

å½“éœ€è¦å¯¹æ•°æ®åº“ä¸­çš„æ•°æ®è¿›è¡ŒæŸ¥è¯¢ã€ä¿®æ”¹ç­‰æ“ä½œæ—¶ï¼ŒæœåŠ¡å™¨éœ€è¦è¿æ¥æ•°æ®åº“ï¼Œè¿›è¡Œå¯¹åº”çš„å¤„ç†ã€‚å¤„ç†å®Œæ¯•åï¼ŒåŒæ ·éœ€è¦è¿”å›ä¿¡æ¯ç»™å®¢æˆ·ç«¯ï¼Œæœ€ç»ˆåé¦ˆç»™ç”¨æˆ·ã€‚

### 3.æ•°æ®åº“
å½“æ•°æ®åº“è¢«æˆåŠŸè¿æ¥åï¼Œé€šè¿‡å¯¹åº”çš„è¯­å¥å’Œæ–¹æ³•å³å¯å¯¹å…¶è¿›è¡Œç›¸å…³æ“ä½œï¼Œå…¶ç»“æœä¼šç›´æ¥ä¼ é€’ç»™æœåŠ¡å™¨ã€‚

# æˆ‘åœ¨å°ç»„ä¸­çš„åˆ†å·¥

ä¸»è¦è´Ÿè´£å®Œæˆæ³¨å†Œï¼Œç™»å½•ï¼Œè·¯ç”±è·³è½¬å’Œé‚®ä»¶åŠŸèƒ½ã€‚åœ¨è¿™å‡ éƒ¨åˆ†çš„åŠŸèƒ½ä¸ŠåŸºæœ¬å·²æŒ‰ç…§å®Œæ•´Webåº”ç”¨æ¶æ„å®Œæˆï¼ŒåŒ…æ‹¬å®¢æˆ·ç«¯ï¼ŒæœåŠ¡å™¨ï¼Œæ•°æ®åº“ä¸‰éƒ¨åˆ†å„è‡ªçš„åŠŸèƒ½ï¼Œä¸‰è€…ä¹‹é—´çš„ç›¸äº’è¿æ¥å’Œç›¸å…³è¯·æ±‚æ“ä½œï¼Œå¹¶å°†ç”¨æˆ·IDä¼ é€’ç»™æ—¥å†ã€‚

æ­¤å¤–ï¼Œå‰æœŸåšäº†ä¸€æ¬¡åˆæ­¥åŠŸèƒ½è®¾è®¡æ–‡æ¡£å’Œæ•°æ®åº“è®¾è®¡ã€‚åæœŸå®Œå–„æ—¥å†ç•Œé¢LOGOéƒ¨åˆ†è®¾è®¡å’Œæ•´ä½“é¢œè‰²è®¾è®¡ã€‚

   ç»„å‘˜|åˆ†æ•°
   ----|----
  æå…¸åº·|10
  æˆšæ™“é¢–|9
  è”¡å¿ƒè•Š|8
  å‘¨å˜‰ç¿”|8

# æˆ‘çš„ç¼–ç¨‹å®è·µæ´»åŠ¨
## æˆ‘çš„ä»£ç 
###1.å®¢æˆ·ç«¯
```dart
//ç™»å½•dart
import 'dart:convert';
import 'dart:html';
import 'dart:async';
import 'package:angular/angular.dart';
import 'package:angular_components/angular_components.dart';
import 'package:angular_components/model/menu/menu.dart';
import 'package:angular_router/angular_router.dart';
import 'package:calendar/src/calendar/calendar_component.dart';
import 'package:calendar/src/route_paths.dart';
import 'package:http/http.dart' as http;
import 'package:calendar/src/routes.dart';

@Component(
  selector: 'login',
  styleUrls: ['login_component.css'],
  templateUrl: 'login_component.html',
  directives: [
    materialInputDirectives,
    MaterialRadioComponent,
    MaterialRadioGroupComponent,
    NgFor,
    NgIf,
    CalendarComponent,
    routerDirectives,
    coreDirectives,
    MaterialFabMenuComponent,
    MaterialButtonComponent,
    MaterialIconComponent,
  ],
  pipes: [commonPipes],
  providers: [popupBindings]
)


class LoginComponent{

  String username = '';
  String password = '';
  Router _router;
  LoginComponent(this._router);

  //è·¯ç”±è·³è½¬
  Future<NavigationResult> gotoRegister() =>
      _router.navigate(RoutePaths.register.toUrl());
  
  //å‘é€ç™»å½•è¯·æ±‚
  login(){
    var client = new http.Client();
    var url = "http://localhost:8002/login";
    var body = json.encode({"username": username,"password": password});
    var headers = {
      "content-type":"application/json"
    };
    
    //æˆåŠŸåè·¯ç”±è·³è½¬
    String _calendarUrl(int id) =>
        RoutePaths.calendar_test.toUrl(parameters: {idParam: '$id'});

    Future<NavigationResult> gotoCalendar(int id) =>
        _router.navigate(_calendarUrl(id));

    client.post(
        url,
        headers: headers,
        body:body)
        .then((response) {
          if(response.statusCode == 200) {
            print(RoutePaths.calendar.toUrl().toString());
            gotoCalendar(int.parse(response.body));
          }
          else
            window.alert("è¯·è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç ");
        })
        .whenComplete(client.close);
  }

}

```


```html
//ç™»å½•html
<div id="content">
    <div style="margin-top: 30px; margin-bottom: 30px">
        <img src="images/logo.png"/>
    </div>
    <div>
        <form style="margin-top: 10px">
            <div class="login-input-box">
                <material-input label="Your Username"
                                class="login-input-box"
                                [(ngModel)]="username">
                </material-input>
            </div>
            <div class="login-input-box">
                <material-input label="Your Password"
                                class="login-input-box"
                                type="password"
                                [(ngModel)]="password">
                </material-input>
            </div>
            <div class="mybutton">
                <material-button raised class="blue" (click)="login()">ç™»å½•</material-button>
            </div>
            <div style="margin-top: -5px">
                <material-button flat class="grey" (click)="gotoRegister()">å»æ³¨å†Œ</material-button>
            </div>
        </form>
    </div>
</div>
```

```css
/*ç™»å½•CSS*/

#content{
    background-color: rgba(255, 255, 255, 0.95);
    width: 480px;
    height: 400px;
    border-radius: 6px;
    box-shadow:0 0 9px #c7ddef;
    padding: 15px;
    margin-top: 10%;
    margin-left: auto;
    margin-right: auto;
    display: block;
    text-align:center
}
.blue {
    background: mediumslateblue;
    color: white;
    width: 80%;
    margin-bottom: 10px;
    margin-top: 15px;
}

.mybutton {
    margin-bottom: 10px;
    margin-top: 10px;
}

.grey {
    color: dimgray;
}

.login-input-box{
     margin-top: 12px;
     width: 90%;
     margin-left: auto;
     margin-right: auto;
     display: inline-block;
 }

.login-input-box input{
    width: 340px;
    height: 32px;
    margin-left: 18px;
    border: 1px solid #dcdcdc;
    border-radius: 4px;
    padding-left: 42px;
}
```

```dart
//æ³¨å†Œdart
import 'dart:convert';
import 'dart:html';
import 'dart:async';
import 'dart:math';
import 'package:angular/angular.dart';
import 'package:angular_components/angular_components.dart';
import 'package:angular_router/angular_router.dart';
import 'package:calendar/src/calendar/calendar_component.dart';
import 'package:calendar/src/route_paths.dart';
import 'package:http/http.dart' as http;
import 'package:calendar/src/routes.dart';

@Component(
  selector: 'register',
  styleUrls: ['register_component.css'],
  templateUrl: 'register_component.html',
  directives: [
    materialInputDirectives,
    MaterialRadioComponent,
    MaterialRadioGroupComponent,
    NgFor,
    NgIf,
    CalendarComponent,
    routerDirectives,
    coreDirectives,
    MaterialButtonComponent
  ],
  pipes: [commonPipes],
)

class RegisterComponent{

  String username = '';
  String password = '';
  String mailbox = '';
  String identify_code ='';
  String code = '';
  Router _router;
  RegisterComponent(this._router);

  //å‘é€é‚®ä»¶è¯·æ±‚
  sendEmail()async {
    if(mailbox.isEmpty){
      window.alert("è¯·è¾“å…¥æ­£ç¡®çš„é‚®ç®±");
    }else{
      var random = Random();
      identify_code = (random.nextInt(8999)+1000).toString();
      var client = new http.Client();
      var url = "http://localhost:8002/sendemail";
      var body = json.encode(
          {"mailbox": mailbox, "identify_code": identify_code});
      var headers = {
        "content-type": "application/json"
      };

      client.post(
          url,
          headers: headers,
          body: body)
          .then((response) {
        if (response.statusCode == 200) {
          window.alert("éªŒè¯ç å·²å‘é€");
        }
        else
          window.alert("è¯·ç¡®è®¤é‚®ç®±æ˜¯å¦æ­£ç¡®");
      })
          .whenComplete(client.close);
    }
  }

  //å‘é€æ³¨å†Œè¯·æ±‚
  register() {
    if (identify_code != code) {
      window.alert("éªŒè¯ç è¾“å…¥é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥");
    }
    else if(identify_code.isEmpty || password.isEmpty || username.isEmpty){
      window.alert("ç”¨æˆ·åï¼Œå¯†ç ï¼Œé‚®ç®±ï¼ŒéªŒè¯ç éœ€å¡«å†™å®Œæ•´");
    }
    else {
      var client = new http.Client();
      var url = "http://localhost:8002/register";
      var body = json.encode(
          {"username": username, "mailbox": mailbox, "password": password});
      var headers = {
        "content-type": "application/json"
      };

      Future<NavigationResult> gotoLogin() =>
          _router.navigate(RoutePaths.login.toUrl());

      client.post(
          url,
          headers: headers,
          body: body)
          .then((response) {
        if (response.statusCode == 200) {
          window.alert("æ³¨å†ŒæˆåŠŸ");
          gotoLogin();
        }
        else
          window.alert("æ³¨å†Œå¤±è´¥");
      })
          .whenComplete(client.close);
    }
  }
  
}

```

```html
<!--æ³¨å†Œhtml-->
<div id="content">
    <h4 style="text-align: center; margin-bottom: 20px; margin-top: 15px">æ–°ç”¨æˆ·æ³¨å†Œ</h4>
    <form>
            <material-input label="ç”¨æˆ·å"
                            [(ngModel)]="username">
            </material-input>
            <material-input label="å¯†ç "
                            type="password"
                            [(ngModel)]="password">
            </material-input>
            <material-input label="é‚®ç®±"
                            [(ngModel)]="mailbox">
            </material-input>

        <div style="text-align: left;margin-left: 10px">
            <material-button flat class="code" (click)="sendEmail()">å‘é€éªŒè¯ç </material-button>
        </div>

        <div style="margin-top: -60px; margin-left: 100px; width: 73%">
            <material-input label="éªŒè¯ç "
                            [(ngModel)]="code">
            </material-input>
        </div>
        <div class="mybutton">
            <material-button raised class="blue" (click)="register()">æ³¨å†Œ</material-button>
        </div>
    </form>
</div>
```

```css
/*æ³¨å†Œcss*/

#content{
    background-color: rgba(255, 255, 255, 0.95);
    width: 420px;
    height: 500px;
    box-shadow:0 0 9px #c7ddef;
    border-radius: 6px;
    padding: 10px;
    margin-top: 7%;
    margin-left: auto;
    margin-right: auto;
    display: block;
    text-align: center;
}

form material-input{
    position: relative;
    width: 90%;
    margin-top: 20px;
    margin-bottom: 5px;
}


.login-input-box{
    margin-top: 12px;
    width: 80%;
    margin-left: auto;
    margin-right: auto;
    display: inline-block;
}

.mybutton {
    margin-bottom: 10px;
    margin-top: 15px;
}

.blue {
    background: mediumslateblue;
    color: white;
    width: 80%;
    margin-bottom: 10px;
}

.login-input-box input{
    width: 340px;
    height: 32px;
    margin-left: 18px;
    border: 1px solid #dcdcdc;
    border-radius: 4px;
    padding-left: 42px;
}

```

```dart
//route_pathså®šä¹‰
import 'package:angular_router/angular_router.dart';

const idParam = 'id';

class RoutePaths {
  static final calendar = RoutePath(path: 'calendar');
  static final login = RoutePath(path: 'login');
  static final register = RoutePath(path: 'register');
  static final calendar_test = RoutePath(path: '${calendar.path}/:$idParam');
}

int getId(Map<String, String> parameters) {
  final id = parameters[idParam];
  return id == null ? null : int.tryParse(id);
}

//routeså®šä¹‰
import 'package:angular_router/angular_router.dart';
import 'route_paths.dart';

export 'route_paths.dart';
import 'calendar/calendar_component.template.dart' as calendar_component;
import 'login/login_component.template.dart' as login_component;
import 'register/register_component.template.dart' as register_component;

class Routes {
  static final calendar = RouteDefinition(
    routePath: RoutePaths.calendar,
    component: calendar_component.CalendarComponentNgFactory,
  );

  static final register = RouteDefinition(
    routePath: RoutePaths.register,
    component: register_component.RegisterComponentNgFactory,
  );

  static final login = RouteDefinition(
    routePath: RoutePaths.login,
    component: login_component.LoginComponentNgFactory,
    useAsDefault: true,
  );

  static final calendar_test = RouteDefinition(
    routePath: RoutePaths.calendar_test,
    component: calendar_component.CalendarComponentNgFactory,
  );

  static final all = <RouteDefinition>[
    login,
    register,
    calendar,
    calendar_test
  ];
}

```
##æœåŠ¡å™¨
```dart
//main.dartï¼ˆå…¥å£æ–‡ä»¶ï¼‰

import 'dart:async';
import 'package:calendar/my_server.dart';
import 'package:aqueduct/aqueduct.dart';

Future main() async {

  final app = Application<MyServerChannel>()
      ..options.configurationFilePath = "config.yaml"
      ..options.port = 8002;

  final count = Platform.numberOfProcessors ~/ 2;
  await app.start(numberOfInstances: count > 0 ? count : 1);

  print("Application started on port: ${app.options.port}.");
  print("Use Ctrl-C (SIGINT) to stop running the application.");
}
```

```dart
//channel.dartï¼ˆæ·»åŠ æ§åˆ¶å™¨ï¼‰

import 'package:calendar/plan.dart';
import 'package:calendar/user.dart';

import 'my_server.dart';

/// This type initializes an application.
///
/// Override methods in this class to set up routes and initialize services like
/// database connections. See http://aqueduct.io/docs/http/channel/.
class MyServerChannel extends ApplicationChannel {
  /// Initialize services in this method.
  ManagedContext context;
  AuthServer authServer;
  /// Implement this method to initialize services, read values from [options]
  /// and any other initialization required before constructing [entryPoint].
  ///
  /// This method is invoked prior to [entryPoint] being accessed.
  @override
  Future prepare() async {
    logger.onRecord.listen((rec) => print("$rec ${rec.error ?? ""} ${rec.stackTrace ?? ""}"));
//    CORSPolicy.defaultPolicy.allowedOrigins = ["http://localhost:8080/"];
  }

  /// Construct the request channel.
  ///
  /// Return an instance of some [Controller] that will be the initial receiver
  /// of all [Request]s.
  ///
  /// This method is invoked after [prepare].
  @override
  Controller get entryPoint {
    final router = Router();

    // Prefer to use `link` instead of `linkFunction`.
    // See: https://aqueduct.io/docs/http/request_controller/
    router
        .route("/login").link(()=>LoginController());
    router
        .route("/register").link(()=>RegisterController());
    router
        .route("/sendemail").link(()=>SendEmailController());
    router
        .route("/senddeademail").link(()=>SendDeadEmailController());

    return router;
  }
}

//ç™»å½•
class LoginController extends ResourceController{

  @Operation.post()
  Future<Response> login(@Bind.body() User testuser) async {
    if(testuser.username == '' || testuser.password == '') {
      return Response.badRequest(body: {"error": "username and password required."});
    }

    String username =testuser.username;

    var selectUserPassword = await User.selectPassword(username);
    print(selectUserPassword);
    if(selectUserPassword == testuser.password){
      var selectUserId = await User.selectId(username);
      return Response.ok(selectUserId);
    }else return Response.badRequest(body: {"error": "wrong username or password."});
  }
}

//æ³¨å†Œ
class RegisterController extends ResourceController{

  @Operation.post()
  Future<Response> register(@Bind.body() User testuser) async {
    bool ifregister = await User.createUser(testuser);
    if(ifregister == true){
      return Response.ok({"success":"register success"});
    }else return Response.badRequest(body: {"error": "register failed"});
  }

}

//å‘é€é‚®ä»¶
class SendEmailController extends ResourceController{

  @Operation.post()
  Future<Response> register(@Bind.body() User testuser) async {
    String identify_Code = testuser.identify_code;
    String mailbox = testuser.mailbox;
    var ifsend = "y";
    ifsend = await User.sendEmail(identify_Code, mailbox);
    print(ifsend);
    if(ifsend == "y"){
      return Response.ok({"success":"send success"});
    }
    else return Response.badRequest(body: {"error": "send failed"});
  }

}

class SendDeadEmailController extends ResourceController{

  @Operation.post()
  Future<Response> register(@Bind.body() Plan testplan) async {
    String mailbox= testplan.mailbox;
    String deadline = testplan.deadline;
    var ifsend = "y";
    ifsend = await Plan.sendEmail(mailbox, deadline);
    print(ifsend);
    if(ifsend == "y"){
      return Response.ok({"success":"send success"});
    }
    else return Response.badRequest(body: {"error": "send failed"});
  }

}

```
```dart
/// my_server
/// A Aqueduct web server.
library my_server;

export 'dart:async';
export 'dart:io';
export 'dart:math';

export 'package:sqljocky5/sqljocky.dart';
export 'package:aqueduct/aqueduct.dart';

export 'channel.dart';

```
```dart
//userç±»å®šä¹‰åŠè¿æ¥æ•°æ®åº“æ“ä½œ

import 'dart:async';
import 'package:aqueduct/aqueduct.dart';
import 'package:sqljocky5/sqljocky.dart';
import 'package:calendar/mailer/mailer.dart';
import 'package:calendar/smtp_server/ecnustumail.dart';
import 'channel.dart';
class User extends Serializable {

  int id;
  String username;
  String password;
  String mailbox;
  String identify_code;

  static Future<List> getAll()async {
    List results;
    var s = ConnectionSettings(
      user: "deit2016",
      password: "deit2016@ecnu",
      host: "www.muedu.org",
      port: 3306,
      db: "deit2016db_10164507121",
    );

    // create a connection
    print("Opening connection ...");
    var conn = await MySqlConnection.connect(s);
    print("Opened connection!");
    Results result = await (await conn
        .execute('SELECT *'
        'FROM users'))
        .deStream();
    print(result);
    print(result.map((r) => r.byName('username')));
    results = result.toList();
    return results;
  }
  
  //æŸ¥æ‰¾ç”¨æˆ·å¯†ç 
  static Future<String> selectPassword(String username)async {
    var stuList;
    String password;
    stuList = await getAll();
    print(username);
    for(int i=0;i<stuList.length;i++){
      if(stuList[i][1]==username)
        password = stuList[i][3];
    }
    if(password!=null){
      return password;
    }else{
      password = "wrong";
      return password;
    }

  }

    //æŸ¥æ‰¾ç”¨æˆ·ID
  static Future<int> selectId(String username)async {
    var stuList;
    int id;
    stuList = await getAll();
    print(username);
    for(int i=0;i<stuList.length;i++){
      if(stuList[i][1]==username)
        id = stuList[i][0];
    }
      return id;
  }

  //å‘é€éªŒè¯é‚®ä»¶
  static Future<String> sendEmail(String code, String mailbox) async {

    String stmpusername = "10164507121@stu.ecnu.edu.cn";
    String stmpassword = "Qxy071561";
    print(mailbox);
    String ifsend = "n";
    List<String> tos = [mailbox]; //æ”¶ä»¶äºº

    //if tos is Empty, send myself
    if (tos.isEmpty)
      tos.add(stmpusername);

    final smtpServer = ecnustumail(stmpusername, stmpassword);
    Iterable<Address> toAd(Iterable<String> addresses) =>
        (addresses ?? <String>[]).map((a) => new Address(a));

    final message = new Message()
      ..from = new Address('10164507121@stu.ecnu.edu.cn')
      ..recipients.addAll(toAd(tos))
      ..subject = 'Test Dart Mailer library :: ğŸ˜€ :: ${new DateTime.now()}'
      ..text = 'This is the plain text.\nThis is line 2 of the text part.'
      ..html = "<h1>Hey! Here's your identity code:</h1>"+code;

    final sendReports = await send(message, smtpServer);
    sendReports.forEach((sr) {
      if (sr.sent) {
        print('Message sent');
        ifsend = "y";
      }
      else {
        print('Message not sent.');
        for (var p in sr.validationProblems) {
          print('Problem: ${p.code}: ${p.msg}');
        }
      }
    });
    return ifsend;
  }

  @override
  void readFromMap(Map<String, dynamic> map) {
    username = map['username'];
    password = map['password'];
    mailbox = map['mailbox'];
    identify_code = map['identify_code'];
  }

  @override
  Map<String, dynamic> asMap() {
    return {
      'username': username,
      'password':password,
      'mailbox':mailbox,
      'identify_code':identify_code
    };
  }

  //åˆ›å»ºæ–°ç”¨æˆ·ï¼Œå†™å…¥æ•°æ®åº“
  static createUser(User testuser) async {
    bool ifRegister = false;
    String username = testuser.username;
    String password = testuser.password;
    String mailbox = testuser.mailbox;
    print(username);
    var s = ConnectionSettings(
      user: "deit2016",
      password: "deit2016@ecnu",
      host: "www.muedu.org",
      port: 3306,
      db: "deit2016db_10164507121",
    );

    // create a connection
    print("Opening connection ...");
    var conn = await MySqlConnection.connect(s);
    print("Opened connection!");

    print("Inserting rows ...");
    await conn.preparedWithAll("INSERT INTO users (username,password,email) VALUES (?,?,?)", [
      [username, password, mailbox],
      ]);
    ifRegister = true;
    return ifRegister;
  }
}
```
```dart
//å®šä¹‰è®¡åˆ’ç±»

import 'dart:async';
import 'package:aqueduct/aqueduct.dart';
import 'package:sqljocky5/sqljocky.dart';
import 'package:calendar/mailer/mailer.dart';
import 'package:calendar/smtp_server/ecnustumail.dart';
import 'channel.dart';
class Plan extends Serializable {

  String mailbox;
  String deadline;


  static Future<String> sendEmail(String mailbox, String deadline) async {

    String stmpusername = "10164507121@stu.ecnu.edu.cn";
    String stmpassword = "Qxy071561";
    print(mailbox);
    String ifsend = "n";
    List<String> tos = [mailbox]; //æ”¶ä»¶äºº

    //if tos is Empty, send myself
    if (tos.isEmpty)
      tos.add(stmpusername);

    final smtpServer = ecnustumail(stmpusername, stmpassword);
    Iterable<Address> toAd(Iterable<String> addresses) =>
        (addresses ?? <String>[]).map((a) => new Address(a));

    final message = new Message()
      ..from = new Address('10164507121@stu.ecnu.edu.cn')
      ..recipients.addAll(toAd(tos))
      ..subject = 'Test Dart Mailer library :: ğŸ˜€ :: ${new DateTime.now()}'
      ..text = 'This is the plain text.\nThis is line 2 of the text part.'
      ..html = "<h1>deadline after</h1>"+deadline.toString()+"<h1>Days</h1>";

    final sendReports = await send(message, smtpServer);
    sendReports.forEach((sr) {
      if (sr.sent) {
        print('Message sent');
        ifsend = "y";
      }
      else {
        print('Message not sent.');
        for (var p in sr.validationProblems) {
          print('Problem: ${p.code}: ${p.msg}');
        }
      }
    });
    return ifsend;
  }

  @override
  void readFromMap(Map<String, dynamic> map) {
    deadline = map['deadline'];
    mailbox = map['mailbox'];
  }

  @override
  Map<String, dynamic> asMap() {
    return {
      'deadline':deadline,
      'mailbox':mailbox,
    };
  }

}
```
```dart
//å®šä¹‰é‚®ç®±æœåŠ¡å™¨
import '../smtp_server.dart';

SmtpServer ecnustumail(String username, String password) =>
    new SmtpServer('smtp.exmail.qq.com', username: username, password: password);
```

## æˆ‘çš„æ´»åŠ¨é‡åŒ–

å§“åï¼šæˆšæ™“é¢–

å­¦å·ï¼š10164507121

**33 commits/ 5,401 ++ / 683 --**


# æˆ‘çš„è‡ªè¯„
è‡ªèº«å®Œæˆå¾—æ¯”è¾ƒå¥½çš„åœ°æ–¹ä¸»è¦å¯¹æ•´ä¸ªWebæ¶æ„æµç¨‹è¿›è¡Œæ¢³ç†ã€æ¢ç´¢ã€å­¦ä¹ ï¼Œææ¸…æ¥šäº†å…¶æ•´ä½“æ¡†æ¶ï¼Œå¯¹äºè¾ƒä¸ºç®€å•çš„Webåº”ç”¨å¼€å‘æœ‰äº†æ€è·¯ä¸æ–¹å‘ã€‚
æ­¤å¤–ï¼Œé™¤äº†å­¦ä¹ angularæ¡†æ¶å¤–ï¼Œè¿˜è‡ªä¸»å®Œæˆäº†å¯¹mailer,http,angular_route,angular_component,sqljocky,aqueductè¿™äº›æ‹“å±•åŒ…çš„å­¦ä¹ ä½¿ç”¨ï¼ŒæŒæ¡æŸ¥è¯¢æ‹“å±•packageçš„èƒ½åŠ›ã€‚ä½†åœ¨æ—¥å†ç•Œé¢çš„ç›¸å…³åˆ¶ä½œä¸Šå‚ä¸è¾ƒå°‘ã€‚

é—æ†¾çš„æ˜¯ç”±äºæ—¶é—´ï¼Œè€ƒè¯•ç­‰åŸå› ï¼Œæœªèƒ½å®Œæˆæ—¥å†ç¾¤ç»„ï¼Œè®¡åˆ’çš„æœåŠ¡å™¨ä¸æ•°æ®åº“è¿æ¥ã€‚
å¦‚æœä»¥ä¸€å¤©å®Œæ•´8å°æ—¶è®¡ç®—ï¼Œå¤§æ¦‚è¿˜éœ€è¦1-2å¤©å®Œæˆå‰©ä¸‹çš„åŠŸèƒ½ï¼Œæœªå®Œæˆçš„ä¸»è¦æ˜¯ä¸€äº›é‡å¤æ€§çš„å·¥ä½œã€‚

# å…³äºæ‰“å°mdæ–‡æ¡£ä¸ºpdf
>æ¯”éƒ¨åˆ†æ˜¯æŒ‡å¯¼ä½ å¦‚ä½•æ‰“å°ä½ çš„è¿™ä¸ªæ–‡æ¡£ä¸ºpdfæ–‡æ¡£çš„è¯´æ˜ï¼Œä¸å±äºæ¨¡æ¿ã€‚
- ä¸‹è½½æŒ‰ç…§æœ‰é“äº‘ç¬”è®°ï¼Œè¯·è‡ªè¡Œæœç´¢å®‰è£…ã€‚
- æ‰“å¼€è½¯ä»¶åæ–°å»ºä¸€ä¸ªmarkdownæ–‡ä»¶ï¼Œå¦‚å›¾
![newmdpng](https://cloud.githubusercontent.com/assets/1710178/21608376/192e708c-d1f7-11e6-870f-81c23f8e2bef.png)

- æŠŠä½ çš„markdownæºæ–‡ä»¶æ”¾è¿›å»ï¼Œå¹¶æŸ¥çœ‹é¢„è§ˆæ•ˆæœã€‚å¦‚å›¾
![editmd](https://cloud.githubusercontent.com/assets/1710178/21608386/2898f0c4-d1f7-11e6-800b-5d73499dfd4c.png)

- åœ¨è¯¥æ–‡ä»¶åˆ—è¡¨ä¸Šå³é”®æ‰“å°ï¼Œå¦‚å›¾ã€‚
![printmd](https://cloud.githubusercontent.com/assets/1710178/21608392/2fc22be0-d1f7-11e6-88c8-5014ba28f24d.png)

- å»ºè®®å¤§å®¶è‡ªè¡Œæœç´¢æŒ‰ç…§foxit readerï¼Œå®ƒä¼šå¸¦ä¸€ä¸ªè™šæ‹Ÿçš„pdfæ–‡ä»¶æ‰“å°æœºï¼Œé€‰æ‹©å®ƒå°±å¯ä»¥æ‰“å°å‡ºpdfæ–‡æ¡£äº†ï¼Œç„¶åä½ å°±å¯ä»¥çº¸è´¨ç‰ˆæ‰“å°è¯¥pdfæäº¤äº†ã€‚
![print2pdf](https://cloud.githubusercontent.com/assets/1710178/21608409/39c50d4c-d1f7-11e6-8c2d-441e5f92a61f.png)

- å„ä½è‡ªå·±è®¾è®¡æ‰“å°ä¸€ä¸ªå°é¢ã€‚
